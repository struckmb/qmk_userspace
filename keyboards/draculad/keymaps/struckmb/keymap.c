#include "struckmb.h"

#define LAYOUT_wrapper(...)           LAYOUT(__VA_ARGS__)
#define LAYOUT_hrm_wrapper(...)       LAYOUT_base_wrapper(__VA_ARGS__)
#define LAYOUT_base_wrapper( \
        k00,k01,k02,k03,k04,  k05,k06,k07,k08,k09, \
        k10,k11,k12,k13,k14,  k15,k16,k17,k18,k19, \
        k20,k21,k22,k23,k24,  k25,k26,k27,k28,k29, \
        e00,e01,k30,k31,k32,k33,k34,k35) \
        LAYOUT_wrapper( \
        MT(MOD_LALT,k00),k01,k02,k03,k04,  k05,k06,k07,k08,MT(MOD_LALT,k09), \
        MT(MOD_LCTL,k10),k11,k12,k13,k14,  k15,k16,k17,k18,MT(MOD_LCTL,k19), \
        MT(MOD_LSFT,k20),k21,k22,k23,k24,  k25,k26,k27,k28,MT(MOD_LSFT,k29), \
        e00,e01,k30,k31,k32,k33,k34,k35)

#define _ENCODERS__ BS_ENC0, BS_ENC1
const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
#ifdef QWERTZ_ENABLE
    [_QWERTZ] = LAYOUT_hrm_wrapper(_QWER_5_L1_, _QWER_5_R1_, //
                               _QWER_5_L2_, _QWER_5_R2_, //
                               _QWER_5_L3_, _QWER_5_R3_, //
                               _ENCODERS__, _THUMB_222_),
#endif // QWERTZ_ENABLE

#ifdef BONE_ENABLE
    [_BONE] = LAYOUT_hrm_wrapper(_BONE_5_L1_, _BONE_5_R1_, //
                             _BONE_5_L2_, _BONE_5_R2_, //
                             _BONE_5_L3_, _BONE_5_R3_, //
                             _ENCODERS__, _THUMB_222_),
#endif // BONE_ENABLE

#ifdef COLEMAK_ENABLE
    [_COLEMAK_DH] = LAYOUT_hrm_wrapper(_COLE_5_L1_, _COLE_5_R1_, //
                                   _COLE_5_L2_, _COLE_5_R2_, //
                                   _COLE_5_L3_, _COLE_5_R3_, //
                                   _ENCODERS__, _THUMB_222_),
#endif // COLEMAK_ENABLE

#ifdef MINE_ENABLE
    [_MINE] = LAYOUT_hrm_wrapper(_MINE_5_L1_, _MINE_5_R1_, //
                                _MINE_5_L2_, _MINE_5_R2_, //
                                _MINE_5_L3_, _MINE_5_R3_, //
                                _ENCODERS__, _THUMB_222_),
#endif // MINE_ENABLE

#ifdef WORKMAN_ENABLE
    [_WORKMAN] = LAYOUT_hrm_wrapper(_WORK_5_L1_, _WORK_5_R1_, //
                                _WORK_5_L2_, _WORK_5_R2_, //
                                _WORK_5_L3_, _WORK_5_R3_, //
                                _ENCODERS__, _THUMB_222_),
#endif // WORKMAN_ENABLE

    // Symbols and Numbers
    [_SYM_NUM] = LAYOUT_wrapper(_SYMB_5_L1_, _SYMB_5_R1_, //
                                _SYMB_5_L2_, _SYMB_5_R2_, //
                                _SYMB_5_L3_, _SYMB_5_R3_, //
                                _ENCODERS__, _SYMB_222_TB_),
    // Navigation and Function
    [_NAV_FUN] = LAYOUT_wrapper(_NAVI_5_L1_, _FUNC_5_R1_, //
                                _NAVI_5_L2_, _FUNC_5_R2_, //
                                _NAVI_5_L3_, _FUNC_5_R3_, //
                                _ENCODERS__, _NAFN_222_TB_),
    // Mouse and Media Control
    [_MSE_CTL] = LAYOUT_wrapper(_MSME_5_L1_, _MSME_5_R1_, //
                                _MSME_5_L2_, _MSME_5_R2_, //
                                _MSME_5_L3_, _MSME_5_R3_, //
                                _ENCODERS__, _MSME_222_TB_),
    // Keyboard adjustments
    [_ADJUST] = LAYOUT_wrapper(_CONF_5_L1_, _CONF_5_R1_, //
                               _CONF_5_L2_, _CONF_5_R2_, //
                               _CONF_5_L3_, _CONF_5_R3_, //
                               _ENCODERS__, _CONF_222_TB_)};

#ifdef OLED_ENABLE
oled_rotation_t oled_init_user(oled_rotation_t rotation) {
 if (is_keyboard_master()) {
     return is_keyboard_left() ? OLED_ROTATION_270 : OLED_ROTATION_90;
 } else {
     return OLED_ROTATION_0;
 }
}

void render_logo_keyboard(uint8_t col, uint8_t row) {
  static const char PROGMEM drac_logo[] = {
    // drac_logo, 128x64px
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x04, 0x0c, 0x18, 0x78, 0xf0, 0xf0, 0xe0, 0xe0, 0xc0,
    0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff,
    0xff, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x03, 0x07, 0x3e, 0xfc, 0xf0, 0x00, 0x00, 0x00,
    0xf0, 0xf0, 0x60, 0x30, 0x30, 0x30, 0x00, 0x00, 0xe0, 0xe0, 0x30, 0x30, 0x30, 0x30, 0x30, 0xe0,
    0xe0, 0x00, 0x00, 0x00, 0x80, 0xc0, 0xe0, 0x70, 0x30, 0x30, 0x30, 0x70, 0xe0, 0xc0, 0x00, 0x00,
    0xf0, 0xf0, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xc0, 0xe0, 0xe0, 0xe0, 0xe0, 0xc0,
    0x80, 0x00, 0x00, 0x00, 0x80, 0xe0, 0xf8, 0xf0, 0x80, 0xc0, 0xe0, 0xf0, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x3f, 0xff, 0xff,
    0xff, 0xff, 0xfe, 0xfc, 0xf8, 0xe0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff,
    0xff, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xc0, 0xe0, 0x7c, 0x3f, 0x0f, 0x00, 0x00, 0x00,
    0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x70, 0xf8, 0xcc, 0x8c, 0x84, 0x86, 0x86, 0xc6, 0xff,
    0xff, 0x80, 0x80, 0x00, 0x3f, 0x7f, 0xe0, 0xc0, 0x80, 0x80, 0x80, 0xc0, 0xf0, 0x71, 0x00, 0x00,
    0x1f, 0xff, 0xff, 0x80, 0x80, 0x80, 0x80, 0xc0, 0xf8, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x03, 0x03, 0x03, 0x07, 0x0f, 0x0f, 0x0f, 0x1f,
    0x7f, 0x7f, 0x3e, 0x3e, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xf8, 0xf8, 0xfc,
    0xfc, 0xfe, 0xfe, 0x7e, 0x7c, 0x78, 0xe0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,
    0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00,
    0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xc0, 0xe0, 0xf0, 0xf8, 0xfe, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff,
    0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xc0, 0x60, 0x60,
    0x60, 0x60, 0x60, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xc0, 0xe0, 0x60, 0x60, 0x60, 0xc0,
    0xc0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x07,
    0x0f, 0x3e, 0x7c, 0xfc, 0xf8, 0xf8, 0xf8, 0xf8, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf8,
    0xf8, 0xf8, 0xfc, 0xfc, 0xfc, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0x7f, 0x3f, 0x1f, 0x0f, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff,
    0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xf1, 0x99, 0x18, 0x08,
    0x0c, 0x0c, 0x8c, 0xff, 0xff, 0x00, 0x00, 0x00, 0x7f, 0xff, 0xc1, 0x80, 0x00, 0x00, 0x00, 0x80,
    0xc3, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x07, 0x07, 0x0f, 0x0f, 0x0f, 0x1f, 0x1f, 0x1f, 0x1f,
    0x1f, 0x1f, 0x1f, 0x1f, 0x1f, 0x1f, 0x1f, 0x1f, 0x1f, 0x0f, 0x0f, 0x07, 0x07, 0x03, 0x03, 0x01,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x01, 0x03, 0x03, 0x03,
    0x03, 0x03, 0x01, 0x01, 0x03, 0x03, 0x03, 0x00, 0x00, 0x01, 0x01, 0x03, 0x03, 0x03, 0x03, 0x01,
    0x01, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
  };
  oled_write_raw_P(drac_logo, sizeof(drac_logo));
}

/* static void render_status(void) { */
/*     oled_write_P(PSTR("This is\n~~~~~~~~~\nDracu\nLad\n~~~~~~~~~\nv1.0\n~~~~~~~~~\n"), false); */
/*     uint8_t n = get_current_wpm(); */
/*     char    wpm_counter[4]; */
/*     wpm_counter[3] = '\0'; */
/*     wpm_counter[2] = '0' + n % 10; */
/*     wpm_counter[1] = (n /= 10) % 10 ? '0' + (n) % 10 : (n / 10) % 10 ? '0' : ' '; */
/*     wpm_counter[0] = n / 10 ? '0' + n / 10 : ' '; */
/*     oled_write_P(PSTR("WPM:"), false); */
/*     oled_write(wpm_counter, false); */
/*     led_t led_state = host_keyboard_led_state(); */
/*     oled_write_P(PSTR("\nCaps: "), false); */
/*     oled_write_P(led_state.caps_lock ? PSTR("on ") : PSTR("off"), false); */
/*     oled_write_P(PSTR("\n"), false); */
/*     switch (get_highest_layer(layer_state)) { */
/*         case _BASE: */
/*             oled_write_P(PSTR("Base   "), false); */
/*             break; */
/*         case _NUM: */
/*             oled_write_P(PSTR("Numbers"), false); */
/*             break; */
/*         case _SYMB: */
/*             oled_write_P(PSTR("Symbols"), false); */
/*             break; */
/*         case _ADJ: */
/*             oled_write_P(PSTR("Adjust "), false); */
/*             break; */
/*         case _MUS: */
/*             oled_write_P(PSTR("Mouse  "), false); */
/*             break; */
/*         default: */
/*             oled_write_P(PSTR("Unkn "), false); */
/*             break; */
/*     } */
/* } */

/* bool oled_task_user(void) { */
/*       if (is_keyboard_master()) { */
/*         render_status(); // Renders the current keyboard state (layer, lock, caps, scroll, etc) */
/*     } else { */
/*         render_logo(); */
/*     } */
/*     return false; */
/* } */
#endif

/* #ifdef ENCODER_ENABLE */
/* bool encoder_update_user(uint8_t index, bool clockwise) { */
/*     if (index == 0) { */
/*         // Volume control */
/*         if (clockwise) { */
/*             tap_code(KC_VOLU); */
/*         } else { */
/*             tap_code(KC_VOLD); */
/*         } */
/*     } */
/*     else if (index == 2) { */
/*       if(clockwise) { */
/*         tap_code(KC_PGUP); */
/*       } */
/*       else{ */
/*         tap_code(KC_PGDN); */
/*       } */
/*     } */
/*     else if (index == 3  ) { */
/*         // Page up/Page down */
/*         if (clockwise) { */
/*           tap_code(KC_WH_U); */
/*         } else { */
/*           tap_code(KC_WH_D); */
/*         } */
/*     } */
/*     return true; */
/* } */
/* #endif */
